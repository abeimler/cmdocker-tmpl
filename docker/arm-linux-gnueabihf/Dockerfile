FROM purplekarrot/arm-linux-gnueabihf

ARG RUN_TESTS=1

ENV BUILD_NAME 'arm-linux-gnueabihf'
ENV BUILD_MODEL 'Experimental'
ENV CHANGE_ID "$(git rev-parse --verify HEAD)"
ENV CTEST_COVERAGE_COMMAND ''
ENV CTEST_MEMORYCHECK_COMMAND ''
ENV CTEST_MEMORYCHECK_TYPE ''
ENV SUBMIT_RESULTS 0
ENV BUILD_PACKAGES 0

ENV BUILD_CONFIG Release
ENV BUILD_PATH /binary/$BUILD_NAME
ENV SOURCE_PATH /source
ENV PREFIX_PATH /prefix
ENV RUN_TESTS $RUN_TESTS
ENV CLEAN_BUILD 0
ENV CMAKE_OPTIONS ''

COPY ./scripts $SOURCE_PATH/scripts

RUN $SOURCE_PATH/scripts/install-deps.sh


VOLUME $BUILD_PATH
VOLUME $SOURCE_PATH
VOLUME $PREFIX_PATH

ENTRYPOINT $SOURCE_PATH/scripts/entrypoint.sh